applications:
  elasticsearch:
    charm: cs:elasticsearch
    num_units: 2
    constraints: mem=8G
    options:
      firewall_enabled: false
  filebeat:
    charm: filebeat
    options:
      logpath: >
              /var/log/syslog
              /var/log/*.log
              /var/log/*/*.log
  graylog:
    charm: cs:graylog
    num_units: 1
    constraints: mem=2G
    options:
      index_replicas: 1
      index_shards: 4
      index_rotation_strategy: size
      index_rotation_size: 10737418240
      index_retention_count: 7
  mongodb:
    charm: cs:mongodb
    num_units: 1
    constraints: mem=1G
    options:
      backups_enabled: true
      bind_ip: 0.0.0.0
  telegraf:
    charm: cs:telegraf
    expose: true
    options:
      prometheus_output_port: default
relations:
  - ['graylog', 'filebeat']
  - ['graylog', 'telegraf']
  - ['graylog', 'elasticsearch']
  - ['graylog', 'mongodb:database']
  - ['elasticsearch:juju-info', 'filebeat:beats-host']
  - ['elasticsearch', 'telegraf']
  - ['mongodb', 'filebeat']
  - ['mongodb', 'telegraf']
# NOTE: filebeat relations to services will need to be added manually e.g.
# - [ filebeat, ceph-mon ]
